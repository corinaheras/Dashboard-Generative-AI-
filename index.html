<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análisis de Sentimientos - Café de Tere</title>
    <style>
        :root {
            --primary: #8B4513;
            --secondary: #D2691E;
            --light: #F5F5DC;
            --dark: #3E2723;
            --positive: #4CAF50;
            --negative: #F44336;
            --neutral: #FFC107;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f9f9f9;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px 0;
            text-align: center;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .sentiment-distribution {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        
        .sentiment-bars {
            display: flex;
            height: 40px;
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .sentiment-bar {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .sentiment-legend {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 10px;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .sentiment-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .example-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            border-left: 5px solid;
        }
        
        .example-text {
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .sentiment-tag {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            color: white;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .muy-positivo { background-color: var(--positive); border-color: var(--positive); }
        .positivo { background-color: #8BC34A; border-color: #8BC34A; }
        .neutral { background-color: var(--neutral); border-color: var(--neutral); color: #333; }
        .negativo { background-color: #FF9800; border-color: #FF9800; }
        .muy-negativo { background-color: var(--negative); border-color: var(--negative); }
        
        .business-info {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .info-item {
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
        }
        
        .info-item h3 {
            color: var(--primary);
            margin-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 5px;
        }
        
        .word-cloud {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            text-align: center;
        }
        
        .word-cloud-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .word-item {
            padding: 5px 10px;
            background: var(--light);
            border-radius: 15px;
            font-size: 0.9rem;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2rem;
            color: var(--primary);
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .sentiment-examples {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Análisis de Sentimientos</h1>
            <p class="subtitle">Café de Tere - Informe detallado de percepciones del público</p>
        </div>
    </header>
    
    <div class="container">
        <div id="loading" class="loading">
            Cargando datos del análisis...
        </div>
        
        <div id="content" style="display: none;">
            <section class="stats-grid">
                <div class="stat-card">
                    <h3>Total de Textos Analizados</h3>
                    <div class="stat-value" id="total-texts">0</div>
                    <p>Comentarios y menciones en redes sociales</p>
                </div>
                <div class="stat-card">
                    <h3>Total de Palabras</h3>
                    <div class="stat-value" id="total-words">0</div>
                    <p>En todos los textos analizados</p>
                </div>
                <div class="stat-card">
                    <h3>Fecha de Análisis</h3>
                    <div class="stat-value" id="analysis-date">-</div>
                    <p>Última actualización</p>
                </div>
            </section>
            
            <section class="sentiment-distribution">
                <h2>Distribución de Sentimientos</h2>
                <div class="sentiment-bars" id="sentiment-bars">
                    <!-- Las barras se generarán con JavaScript -->
                </div>
                <div class="sentiment-legend" id="sentiment-legend">
                    <!-- La leyenda se generará con JavaScript -->
                </div>
            </section>
            
            <section class="business-info">
                <h2>Información del Negocio</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <h3>Historia del Café de Tere</h3>
                        <p>El Café de Tere es un emprendimiento ecuatoriano que comenzó como un pequeño negocio familiar y ha crecido hasta convertirse en una cadena reconocida. Su especialidad son los bolones (plato típico ecuatoriano) y otros platos tradicionales.</p>
                    </div>
                    <div class="info-item">
                        <h3>Productos Destacados</h3>
                        <p>• Bolón mixto (verde y maduro)<br>
                           • Tigrillo<br>
                           • Ají<br>
                           • Variedad de cafés y jugos</p>
                    </div>
                    <div class="info-item">
                        <h3>Ubicaciones</h3>
                        <p>Con múltiples locales en Guayaquil, el Café de Tere se ha expandido manteniendo su esencia y calidad. Es especialmente popular para desayunos y almuerzos.</p>
                    </div>
                    <div class="info-item">
                        <h3>Percepción de Precios</h3>
                        <p>Uno de los temas recurrentes en los comentarios es la percepción sobre los precios, con opiniones divididas entre quienes consideran que ofrecen buena relación calidad-precio y quienes los encuentran elevados.</p>
                    </div>
                </div>
            </section>
            
            <section class="word-cloud">
                <h2>Palabras Más Mencionadas</h2>
                <div class="word-cloud-container" id="word-cloud">
                    <!-- Las palabras se generarán con JavaScript -->
                </div>
            </section>
            
            <section class="sentiment-examples">
                <h2 style="margin-bottom: 20px;">Ejemplos de Comentarios por Categoría</h2>
                <div id="sentiment-examples">
                    <!-- Los ejemplos se generarán con JavaScript -->
                </div>
            </section>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>Análisis de sentimientos generado el <span id="footer-date">-</span> | Datos recopilados de redes sociales</p>
        </div>
    </footer>

    <script>
        // Configuración de colores para cada sentimiento
        const sentimentColors = {
            "muy_positivo": "#4CAF50",
            "positivo": "#8BC34A",
            "neutral": "#FFC107",
            "negativo": "#FF9800",
            "muy_negativo": "#F44336"
        };
        
        // Configuración de nombres para mostrar
        const sentimentLabels = {
            "muy_positivo": "Muy Positivo",
            "positivo": "Positivo",
            "neutral": "Neutral",
            "negativo": "Negativo",
            "muy_negativo": "Muy Negativo"
        };

        // Función para cargar y procesar los datos JSON
        async function loadData() {
            try {
                // Cargar el archivo de análisis de sentimientos
                const response = await fetch('analisis_sentimientos.json');
                const analysisData = await response.json();
                
                // Procesar los datos
                processAnalysisData(analysisData);
                
            } catch (error) {
                console.error('Error cargando los datos:', error);
                document.getElementById('loading').innerHTML = 
                    'Error cargando los datos. Por favor verifica que el archivo JSON esté disponible.';
            }
        }

        // Función para procesar los datos del análisis
        function processAnalysisData(analysisData) {
            // Ocultar loading y mostrar contenido
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';
            
            // Actualizar estadísticas generales
            document.getElementById('total-texts').textContent = analysisData.total_texts.toLocaleString();
            document.getElementById('total-words').textContent = analysisData.total_words.toLocaleString();
            document.getElementById('analysis-date').textContent = new Date(analysisData.analysis_date).toLocaleDateString('es-ES');
            document.getElementById('footer-date').textContent = new Date(analysisData.analysis_date).toLocaleDateString('es-ES');
            
            // Calcular distribución de sentimientos
            const sentimentCounts = {
                "muy_positivo": 0,
                "positivo": 0,
                "neutral": 0,
                "negativo": 0,
                "muy_negativo": 0
            };
            
            analysisData.sentiment_results.forEach(result => {
                if (sentimentCounts.hasOwnProperty(result.label)) {
                    sentimentCounts[result.label]++;
                }
            });
            
            const totalResults = analysisData.sentiment_results.length;
            
            // Crear barras de distribución de sentimientos
            const sentimentBars = document.getElementById('sentiment-bars');
            const sentimentLegend = document.getElementById('sentiment-legend');
            
            sentimentBars.innerHTML = '';
            sentimentLegend.innerHTML = '';
            
            for (const sentiment in sentimentCounts) {
                const percentage = Math.round((sentimentCounts[sentiment] / totalResults) * 100);
                
                // Crear barra
                const bar = document.createElement('div');
                bar.className = 'sentiment-bar';
                bar.style.width = `${percentage}%`;
                bar.style.backgroundColor = sentimentColors[sentiment];
                bar.textContent = percentage > 5 ? `${percentage}%` : '';
                sentimentBars.appendChild(bar);
                
                // Crear elemento de leyenda
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                
                const colorBox = document.createElement('div');
                colorBox.className = 'legend-color';
                colorBox.style.backgroundColor = sentimentColors[sentiment];
                
                const label = document.createElement('span');
                label.textContent = `${sentimentLabels[sentiment]}: ${sentimentCounts[sentiment]} (${percentage}%)`;
                
                legendItem.appendChild(colorBox);
                legendItem.appendChild(label);
                sentimentLegend.appendChild(legendItem);
            }
            
            // Crear ejemplos de comentarios por categoría
            createSentimentExamples(analysisData.sentiment_results);
            
            // Crear nube de palabras (simulada basada en los textos más comunes)
            createWordCloud(analysisData.sentiment_results);
        }

        // Función para crear ejemplos de comentarios
        function createSentimentExamples(sentimentResults) {
            const sentimentExamples = document.getElementById('sentiment-examples');
            sentimentExamples.innerHTML = '';
            
            // Agrupar comentarios por sentimiento
            const commentsBySentiment = {
                "muy_positivo": [],
                "positivo": [],
                "neutral": [],
                "negativo": [],
                "muy_negativo": []
            };
            
            sentimentResults.forEach(result => {
                if (commentsBySentiment.hasOwnProperty(result.label)) {
                    commentsBySentiment[result.label].push(result);
                }
            });
            
            // Crear ejemplos para cada categoría (máximo 3 por categoría)
            for (const sentiment in commentsBySentiment) {
                const examples = commentsBySentiment[sentiment].slice(0, 3);
                
                examples.forEach(example => {
                    const exampleCard = document.createElement('div');
                    exampleCard.className = `example-card ${sentiment.replace('_', '-')}`;
                    
                    const exampleText = document.createElement('p');
                    exampleText.className = 'example-text';
                    // Acortar texto muy largo
                    const shortText = example.text.length > 150 ? 
                        example.text.substring(0, 150) + '...' : example.text;
                    exampleText.textContent = `"${shortText}"`;
                    
                    const sentimentTag = document.createElement('div');
                    sentimentTag.className = `sentiment-tag ${sentiment.replace('_', '-')}`;
                    sentimentTag.textContent = `${sentimentLabels[sentiment]} (${(example.score * 100).toFixed(1)}%) - ${example.stars}★`;
                    
                    exampleCard.appendChild(exampleText);
                    exampleCard.appendChild(sentimentTag);
                    sentimentExamples.appendChild(exampleCard);
                });
            }
        }

        // Función para crear una nube de palabras simulada
        function createWordCloud(sentimentResults) {
            const wordCloud = document.getElementById('word-cloud');
            wordCloud.innerHTML = '';
            
            // Palabras comunes relacionadas con el Café de Tere (basado en el análisis)
            const commonWords = [
                'bolón', 'Tere', 'café', 'rico', 'bueno', 'caro', 'sobrevalorado',
                'sabor', 'precio', 'servicio', 'tigrillo', 'maduro', 'verde',
                'mixto', 'calidad', 'limpieza', 'emprendimiento', 'éxito'
            ];
            
            // Agregar palabras a la nube
            commonWords.forEach(word => {
                const wordItem = document.createElement('div');
                wordItem.className = 'word-item';
                wordItem.textContent = word;
                wordCloud.appendChild(wordItem);
            });
        }

        // Inicializar la carga de datos cuando se carga la página
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>